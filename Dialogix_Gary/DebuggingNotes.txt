9/25/2007

Re-commented all Evidence code so that only TricepsTimingCalculator is called:

Errors
(1) RawData not updated
(2) EnglishFrenchDemo not updated
(3) InstrumentSession not updated
(4) PageHitEvents - only partially updated
(5) PageHit updated, but wrong times

Instrument_Session_ID is 0 before most errors

Updates do occur (enough? - compare to without comments) - is problem just session ID?

-----
9/26/2007

data.MysqlInstrumentSessionDAO->setInstrumentSession:63 - instrument_id = 0 - is that session? instrument?

-----
9/30/2007

Unicode Debugging Notes
(1) MySQL does accurately store Unicode text (russian, Hebrew) if use PHPMyadmin to enter and save it.  So Mysql will be fine once can load proper data into it.
(2) Velocity Macros also print proper text (so Java Parser is working)
(3) .dat files show proper Unicode (whether using UTF-16 or UTF-8)
(4) .dat.evt are wrong - JavaScript 1.2 (the version I was using) does not support Unicode. When I declare JavaScript 1.5, no change
(5) Need to test Mysql drivers for unicode compatability (e.g. load results of Velocity Macros into a table
(6) Entering UTF-8 into any input field (text, memo) yields wrong answer.  Unicode in non-text fieds is fine, but may be due to using internal coded values in return statements
(5) 

------
10/5/2007

Database Writing
- Seems to be largely fixed (no NullPointerException; one row per desired session; updates are happening)
- However, there are many wrong or missing values which need to be corrected
- Make sure to CVS this before doing much more!

Unicode
- UTF-16 to Log4J let me see some contents correctly, confirming that error is not on Log4J side

------
10/7/2007

Notes from running the Gary's revised code

(1) EnglishRussianFrenchHebrew
(2) InstrumentSession
(3) PageHitEvents
(4) PageHits
(5) RawData

-- Note, can't use on update CURRENT_TIMESTAMP on two rows, so application must enforce accurate start and end times.
-- N.B.  Focus on InstrumentSession, InstrumentSessionData, and RawData - Ignore PageHits and PageHitEvents for now!!!!

// InstrumentSessionDataDAO
englishrussianfrenchhebrew
  InstrumentName - OK
  InstanceName - OK
  StartTime - OK 
  end_time - OK
  first_group - OK
  last_group - OK
  last_action - MISSING	/skip	req.getParameter("DIRECTIVE")	[10/15 - set this in PageHitBean]
  last_access - MISSING	/skip	-- supposed to be time (end_time, so SKIP)
  status_message - MISSING	/skip	LOGIN_ERRS_BRIEF[result])
  instrument_session_id - OK
  <DisplayNum> - Add, so know how far into a given session the user is	/FIXME

// InstrumentSessionDAO
instrument_session
  instrument_session_id - OK
  start_time - OK
  end_time - OK
  instrument_id - OK
  instrument_version_id - OK
  user_id - OK (but N/A)	/skip
  first_group - OK
  last_group - OK
  last_action - MISSING	/skip	req.getParameter("DIRECTIVE")
  last_access - MISSING	/skip -- supposed to be time (end_time, so SKIP)
  statusMsg - MISSING	/skip LOGIN_ERRS_BRIEF[result])
  <DisplayNum> - Add, so know how far into a given session the user is	/FIXME

// PageHitEventsDAO (?)
pagehitevents 
  pageHitEventsID - OK
  pageHitID - OK	
  varName - OK
  actionType - OK
  eventType - OK
  `timestamp` - OK
  duration - OK
  value1 - OK	// except change events aren't showing the final value after series of keypresses
  value2 - OK

// PageHitsDAO (?)
pagehits 
  pageHitID - OK
  instrument_session_id - OK (always 0)	/FIXME
  `timeStamp` - OK
  accessCount - OK, but how used?	/skip
  groupNum - OK	/FIXME (is it really OK?)
  displayNum - OK - at least first several are - accessCount is better	/FIXME
  lastAction - OK (but present)	/skip
  statusMsg - OK
  totalDuration - WRONG (huge)	/FIXME (last entry in EVENT_TIMING)
  serverDuration - WRONG (huge)	/FIXME (computed from TricepsTimingCalculator)
  loadDuration - OK (? - < 100 ms, which seems right)
  networkDuration - ?? (= 0, but working on localhost)	/FIXME (check calculation)
  pageVacillation - WRONG (always 1)	/was this so can do SQL to add # of hits?

// MysqlRawDataDAO
// Set from TTC - exclusively from writeNode?
rawdata 
  RawDataID	- OK
  instrument_session_id - OK
  InstrumentName - OK
  InstanceName - OK
  VarName - OK
  VarNum - BAD - always -1 - but is this really used?	/skip
  GroupNum - OK - it is using DisplayNum	/FIXME (but could be done within InstumentModel on load
  DisplayNum - OK 
  LangNum - OK, but using number from list of languages - should really use the Java ISO code (like "en" or "ru")	/FIXME (from InstrumentLoad)
  WhenAsMS - OK
  `TimeStamp` - OK, but do we really need both (is there an easy conversion between WhenAsMS and TimeStamp
  AnswerType - OK
  Answer - OK, but Unicode part not working.  The NullFlavor part is (*REFUSED*, *UNASKED*, etc.)	/FIXME (Unicode part)
  QuestionAsAsked - OK, but Unicode part not working	/FIXME (unicode part)
  itemVacillation - BAD - always 0	/FIXME - count # change events for a variable within EVENT_TIMING
  responseLatency - BAD - always 0	/FIXME - for a variable, time from focus to next event (as long as next event is not blur)
	// EventAggregate
	// // Evidence - from qtb 
	// PageHitBean (calls EventAggregate - the only function which calls it, via processEvents())
	// QuestionTimingBean (but not used)?
	// TricepsTimingCalculator (using QTB, but not set) (supposed to be?)
	// PageHitBean.processEvents() - it's store() called from TTC
  responseDuration - BAD - always 0	/FIXME - for a variable, time from focus to blur
  nullFlavor - BAD - always 0	/skip
  `Comment` - OK
  <crosspageItemVacillation> - ADD - Assuming have an in-memory representation of data (one row per item), increment it each time an item visited (changed? both?)

[ ] Concurrency - when trying to run two simultaneous sessions, they got confused - why?
---
10/9/2007

Unicode Debugging Notes
(1) MySQL does accurately store Unicode text (russian, Hebrew) if use PHPMyadmin to enter and save it.  So Mysql will be fine once can load proper data into it.
(2) Velocity Macros also print proper text (so Java Parser is working)
(3) .dat files OK
(4) .dat.evt files OK
(5) Entering unicode (Russian, Hebrew) into Dialogix data entry fields yields expected value - SO, Sufficiently working?
(6) Test jar/unjar of data - OK
(7) Test jar/unjar of instruments - BAD - when restore, the character values are wrong (but can avoid this by forcing use of .txt files
[ ] Test Mysql for unicode compatability (e.g. load results of Velocity Macros into a table
[ ] Log4J not showing unicode?